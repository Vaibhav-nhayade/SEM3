<script>
  const MAX_CHARS = 500;

  // Clamp while typing (no UI change)
  (function clampInputs() {
    const paragraphEl = document.getElementById('paragraph');
    const countEl = document.getElementById('questionCount');

    paragraphEl.addEventListener('input', (e) => {
      if (e.target.value.length > MAX_CHARS) {
        e.target.value = e.target.value.slice(0, MAX_CHARS);
      }
    });

    countEl.addEventListener('input', () => {
      const n = parseInt(countEl.value || '0', 10);
      if (n > 10) countEl.value = 10;
      if (n < 1) countEl.value = 1;
    });
  })();

  // Your existing function â€“ just add these checks at the top
  async function generateQuiz() {
    const paragraph = document.getElementById('paragraph').value.trim();
    const quizType = document.getElementById('quizType').value;
    const questionCount = document.getElementById('questionCount').value;

    // NEW: lightweight validation (no visual changes)
    if (!paragraph) {
      alert("Please enter a paragraph.");
      return;
    }
    if (paragraph.length > MAX_CHARS) {
      alert(`Paragraph must be ${MAX_CHARS} characters or fewer.`);
      return;
    }
    const qty = parseInt(questionCount || '0', 10);
    if (isNaN(qty) || qty < 1 || qty > 10) {
      alert("Number of questions must be between 1 and 10.");
      return;
    }

    // ...the rest of your existing code stays the same
    const response = await fetch("http://localhost:5000/generate", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ paragraph, quizType, questionCount: qty })
    });

    const data = await response.json();
    const quizOutput = document.getElementById('quizOutput');
    quizOutput.innerHTML = "";

    data.questions.forEach((q, i) => {
      quizOutput.innerHTML += `<p class="mb-2 font-semibold">${i + 1}. ${q.question}</p>`;
      if (q.options) {
        q.options.forEach(opt => {
          quizOutput.innerHTML += `<p class="ml-4">- ${opt}</p>`;
        });
      }
    });

    quizOutput.classList.remove("hidden");
  }
</script>
